From 7e284755b4e2f21cbeb9ef9b4ca42e3e1cb8252b Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Fri, 29 May 2020 21:20:45 +0300
Subject: [PATCH 201/203] Add Mender support

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 configs/ucm-imx8m-mini_defconfig | 2 ++
 include/configs/ucm-imx8m-mini.h | 4 ++--
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/configs/ucm-imx8m-mini_defconfig b/configs/ucm-imx8m-mini_defconfig
index 2955b2f907..6b6e935ebf 100644
--- a/configs/ucm-imx8m-mini_defconfig
+++ b/configs/ucm-imx8m-mini_defconfig
@@ -37,6 +37,8 @@ CONFIG_EFI_PARTITION=y
 CONFIG_PARTITION_TYPE_GUID=y
 CONFIG_OF_CONTROL=y
 CONFIG_ENV_IS_IN_MMC=y
+CONFIG_BOOTCOUNT_LIMIT=y
+CONFIG_BOOTCOUNT_ENV=y
 CONFIG_IMX8M_LPDDR4=y
 CONFIG_DM_GPIO=y
 CONFIG_SYS_I2C_MXC=y
diff --git a/include/configs/ucm-imx8m-mini.h b/include/configs/ucm-imx8m-mini.h
index cd1ed129f9..73b23504c3 100644
--- a/include/configs/ucm-imx8m-mini.h
+++ b/include/configs/ucm-imx8m-mini.h
@@ -198,8 +198,8 @@
         (CONFIG_SYS_INIT_RAM_ADDR + CONFIG_SYS_INIT_SP_OFFSET)
 
 #define CONFIG_ENV_OVERWRITE
-#define CONFIG_ENV_OFFSET               (64 * SZ_64K)
-#define CONFIG_ENV_SIZE			0x1000
+#define CONFIG_ENV_OFFSET               0x1000
+#define CONFIG_ENV_SIZE			0x4000
 #define CONFIG_SYS_MMC_ENV_DEV		0   /* USDHC2 */
 #define CONFIG_MMCROOT			"/dev/mmcblk1p2"  /* USDHC2 */
 
-- 
2.11.0

